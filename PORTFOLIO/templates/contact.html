{% extends "base.html" %}

{% block title %}Contact - Vinayak S Khosh{% endblock %}

{% block content %}
<section class="contact-section py-5">
    <div class="container">
        <h1 class="display-4 fw-bold text-center mb-5">Get In Touch</h1>
        
        <div class="row">
            <div class="col-lg-6 mb-4">
                <div class="card shadow-sm h-100">
                    <div class="card-body">
                        <h3 class="card-title mb-4">
                            <i class="fas fa-address-card text-primary"></i> Contact Information
                        </h3>
                        
                        <div class="contact-item mb-4">
                            <h5><i class="fas fa-map-marker-alt text-danger"></i> Location</h5>
                            <p class="text-muted">{{ contact.location }}</p>
                        </div>
                        
                        <div class="contact-item mb-4">
                            <h5><i class="fas fa-phone text-success"></i> Phone / WhatsApp</h5>
                            <p>
                                <a href="tel:9744360607" class="text-decoration-none">9744360607</a>
                                <br>
                                <a href="https://wa.me/919744360607" target="_blank" class="btn btn-success btn-sm mt-2">
                                    <i class="fab fa-whatsapp"></i> Chat on WhatsApp
                                </a>
                            </p>
                        </div>
                        
                        <div class="contact-item mb-4">
                            <h5><i class="fas fa-envelope text-primary"></i> Email</h5>
                            <p><a href="mailto:{{ contact.email }}" class="text-decoration-none">{{ contact.email }}</a></p>
                        </div>
                        
                        <div class="contact-item mb-4">
                            <h5><i class="fab fa-github text-dark"></i> GitHub</h5>
                            <p><a href="{{ contact.github }}" target="_blank" class="text-decoration-none">{{ contact.github }}</a></p>
                        </div>
                        
                        <div class="contact-item mb-4">
                            <h5><i class="fab fa-linkedin text-info"></i> LinkedIn</h5>
                            <p><a href="{{ contact.linkedin }}" target="_blank" class="text-decoration-none">View Profile</a></p>
                        </div>
                        
                        <div class="social-links-large mt-4">
                            <a href="https://wa.me/919744360607" class="btn btn-success btn-lg me-2 mb-2" target="_blank">
                                <i class="fab fa-whatsapp"></i> WhatsApp
                            </a>
                            <a href="{{ contact.github }}" class="btn btn-dark btn-lg me-2 mb-2" target="_blank">
                                <i class="fab fa-github"></i> GitHub
                            </a>
                            <a href="{{ contact.linkedin }}" class="btn btn-primary btn-lg me-2 mb-2" target="_blank">
                                <i class="fab fa-linkedin"></i> LinkedIn
                            </a>
                            <a href="mailto:vinayaksunilkhosh@gmail.com" class="btn btn-danger btn-lg mb-2">
                                <i class="fas fa-envelope"></i> Email
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-lg-6 mb-4">
                <div class="card shadow-sm h-100">
                    <div class="card-body">
                        <h3 class="card-title mb-4">
                            <i class="fas fa-paper-plane text-primary"></i> Send a Message
                        </h3>
                        
                        <form id="contactForm">
                            <div class="mb-3">
                                <label for="name" class="form-label">Your Name</label>
                                <input type="text" class="form-control" id="name" required>
                            </div>
                            
                            <div class="mb-4">
                                <label class="form-label fw-bold">Choose how to send:</label>
                                <div class="btn-group w-100" role="group">
                                    <input type="radio" class="btn-check" name="contactMethod" id="methodEmail" value="email" checked>
                                    <label class="btn btn-outline-primary" for="methodEmail">
                                        <i class="fas fa-envelope"></i> Send via Email
                                    </label>
                                    
                                    <input type="radio" class="btn-check" name="contactMethod" id="methodWhatsApp" value="whatsapp">
                                    <label class="btn btn-outline-success" for="methodWhatsApp">
                                        <i class="fab fa-whatsapp"></i> Send via WhatsApp
                                    </label>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label for="email" class="form-label">Your Email</label>
                                <input type="email" class="form-control" id="email" required>
                            </div>
                            
                            <div class="mb-3">
                                <label for="subject" class="form-label">Subject</label>
                                <input type="text" class="form-control" id="subject" required>
                            </div>
                            
                            <div class="mb-3">
                                <label for="message" class="form-label">Message</label>
                                <textarea class="form-control" id="message" rows="5" required></textarea>
                            </div>
                            
                            <button type="submit" class="btn btn-primary btn-lg w-100" id="submitBtn">
                                <i class="fas fa-paper-plane"></i> <span id="btnText">Send via Email</span>
                            </button>
                        </form>
                        
                        <div class="alert alert-info mt-3">
                            <i class="fas fa-info-circle"></i> 
                            Email: <strong>vinayaksunilkhosh@gmail.com</strong><br>
                            WhatsApp: <strong>9744360607</strong>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

{% block extra_js %}
<script>
// Update button text and color based on selected method
const methodRadios = document.querySelectorAll('input[name="contactMethod"]');
const submitBtn = document.getElementById('submitBtn');
const btnText = document.getElementById('btnText');

methodRadios.forEach(radio => {
    radio.addEventListener('change', function() {
        if (this.value === 'email') {
            submitBtn.className = 'btn btn-primary btn-lg w-100';
            btnText.textContent = 'Send via Email';
        } else {
            submitBtn.className = 'btn btn-success btn-lg w-100';
            btnText.textContent = 'Send via WhatsApp';
        }
    });
});

document.getElementById('contactForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const name = document.getElementById('name').value;
    const email = document.getElementById('email').value;
    const subject = document.getElementById('subject').value;
    const message = document.getElementById('message').value;
    const method = document.querySelector('input[name="contactMethod"]:checked').value;
    
    // Disable button
    submitBtn.disabled = true;
    const originalText = btnText.textContent;
    btnText.textContent = 'Sending...';
    
    try {
        const response = await fetch('/send-contact', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                name: name,
                email: email,
                subject: subject,
                message: message,
                method: method
            })
        });
        
        const result = await response.json();
        
        if (result.status === 'success') {
            if (method === 'email') {
                // For email, just show success and give option to open email client
                alert('✅ Message saved!\n\nYour message has been recorded. You can also send it directly via email by clicking OK.');
                // Don't auto-redirect to mailto, give user choice
                if (confirm('Open your email client to send this message now?')) {
                    window.location.href = result.redirect;
                }
            } else {
                // For WhatsApp, open in new tab
                alert('✅ Message saved! Opening WhatsApp...');
                window.open(result.redirect, '_blank');
            }
            
            // Reset form
            this.reset();
        } else {
            alert('❌ Error: ' + result.message);
        }
    } catch (error) {
        alert('❌ Error sending message: ' + error.message);
    } finally {
        // Re-enable button
        submitBtn.disabled = false;
        btnText.textContent = originalText;
    }
});
</script>
{% endblock %}
{% endblock %}
